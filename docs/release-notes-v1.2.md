# J‑Circuit v1.2 Release Notes

## 概述
- 引入多分析方法：瞬态分析、节点电压法、支路电流法、网孔电流法、戴维南等效。
- 打通前后端仿真链路：前端将画布状态构造成标准载荷；后端使用 ModelingToolkit 与 DifferentialEquations 求解。
- 增强可视化与教学：方法对比模式、教学模式（显示矩阵与步骤）、节点/元件电压显示与支路电流标注。

## 新增与改进
- 分析方法选择与对比
  - 在控制面板选择 `transient | node_voltage | branch_current | mesh_current | thevenin`。
  - 纯电阻电路可启用多方法对比，结果按列并排展示。
  - 戴维南分析支持在 UI 选择端口（正端/负端）。
- 教学模式（纯电阻方法）
  - 返回矩阵与求解步骤，前端结果面板结构化展示关键过程。
- 电压显示模式
  - `node`：显示节点电压；`element`：显示元件两端电压差（电压源同时显示副行）。
- 载荷构建器增强
  - 自动检测纯电阻电路并推荐默认方法；验证参数与连线完整性；生成网络 `nets` 与组件连接。
  - 端口旋转映射（180° 时 p/n、pos/neg、ctrl_p/ctrl_n 互换），保证后端连接语义正确。
- 组件编号与项目管理
  - 画布侧按组件类型连续编号（R1、R2…）；支持项目导入/导出。
- 结果展示与标注
  - 渲染多波形；节点电压与支路电流在画布上联动展示；错误响应友好提示。

## 后端要点
- 组件验证与实例化：统一的 JSON schema 解析与参数校验。
- 网络组装与方程生成：基于 ModelingToolkit 生成 ODE/代数系统。
- 求解配置：遵循 `t_stop` 与 `n_samples`；按方法返回标准化响应包。

## 兼容性与约束
- 非纯电阻电路（含电容/电感或交流源）仅支持瞬态分析。
- 电路必须包含至少一个电源且网络端口必须成对连接。
- 方法对比与教学模式仅适用于纯电阻直流方法。
- 端口命名需符合组件定义（如 `p/n`、`pos/neg`、受控源 `ctrl_p/ctrl_n`）。

## 已知问题与后续计划
- 大规模电路的前端渲染性能需进一步优化（虚拟化与分层绘制）。
- 教学模式矩阵渲染在极大规模时可读性下降，后续考虑分页/折叠。
- 未来版本将补充更多受控源与探针类型，并完善 AC 分析。

## 升级与运行
- 前端：`web/` 目录安装依赖后运行 `npm run dev`。
- 后端：`server/` 目录安装 Julia 依赖后运行服务脚本。
- 通过工作区的控制面板选择方法、设置 `tStop` 与 `nSamples`，运行并查看结果。